<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate href=/index.xml type=application/rss+xml title=WampSharp><link rel=icon href=https://wampsharp.net/favicon.ico><title>Cookie based router-side authentication - WampSharp</title><link rel=stylesheet href=https://wampsharp.net/css/highlight/github.css><link rel=stylesheet href=https://wampsharp.net/css/bootstrap.min.css><link rel=stylesheet href=https://wampsharp.net/css/bootstrap-theme.min.css><link rel=stylesheet href=https://wampsharp.net/css/theme.css><link rel=stylesheet href=https://wampsharp.net/css/bootie-docs.css><link rel=stylesheet href=https://wampsharp.net/css/site.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@v2.6.3/dist/cdn/docsearch.min.css></head><body role=document><nav class="navbar navbar-inverse navbar-fixed-top"><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar aria-expanded=false aria-controls=navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://wampsharp.net/>WampSharp</a></div><div id=navbar class="navbar-collapse collapse"><ul class="nav navbar-nav"><li><a href=https://wampsharp.net/>Home</a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Categories<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a href=https://wampsharp.net/categories/authentication>Authentication</a></li><li><a href=https://wampsharp.net/categories/callee>Callee</a></li><li><a href=https://wampsharp.net/categories/caller>Caller</a></li><li><a href=https://wampsharp.net/categories/client>Client</a></li><li><a href=https://wampsharp.net/categories/getting-started>Getting-Started</a></li><li><a href=https://wampsharp.net/categories/publisher>Publisher</a></li><li><a href=https://wampsharp.net/categories/release-notes>Release-Notes</a></li><li><a href=https://wampsharp.net/categories/roadmap>Roadmap</a></li><li><a href=https://wampsharp.net/categories/router>Router</a></li><li><a href=https://wampsharp.net/categories/subscriber>Subscriber</a></li><li><a href=https://wampsharp.net/categories/wamp1>Wamp1</a></li></ul></li></ul><form class="navbar-form navbar-left" role=search><div class="input-group doc-search-form"><input type=text id=as_q class="search-query doc-search-input-text" placeholder="Search Site"></div></form></div></div></nav><div class=container><div class=row><div class="col-sm-8 doc-main"><main role=main><article><a id=title></a><h1 class=doc-entry-title>Cookie based router-side authentication</h1><div class=doc-entry-meta><span><time datetime=2017-07-30>July 30, 2017</time></span></div><section><p>It is possible to build authenticators that are cookie-based. In order to that, one needs to implement an interface named ICookieAuthenticatorFactory and pass it to DefaultWampAuthenticationHost&rsquo;s constructor, (or to FleckAuthenticatedWebSocketTransport/VtortolaAuthenticatedWebSocketTransport constructors).</p><p>The interface consists of a single method named &ldquo;CreateAuthenticator&rdquo;, which receives as a parameter an ICookieProvider, that is an interface that allows to access client cookies for read-only.</p><p>The authenticator created by the &ldquo;CreateAuthenticator&rdquo; method will be passed to the IWampSessionAuthenticatorFactory passed to the (Default)WampAuthenticationHost as the transportAuthenticator parameter. This allows to combine between authentication methods.</p><blockquote><p>Note: it is not possible to set cookies from WampSharp. At this moment <a href=https://github.com/statianzo/Fleck>Fleck</a> doesn&rsquo;t support cookie set on Handshake, so this won&rsquo;t be possible until someone implements this feature.</p></blockquote><h2 id=example>Example</h2><p>This example demonstrates cookie-based authenticator usage. Cookies are set using an embedded <a href=https://github.com/Code-Sharp/uHttpSharp>uhttpSharp server</a>.</p><p>Open <code>http://localhost</code> in your browser to see this demo in action.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>using</span> System;
<span style=color:#66d9ef>using</span> System.Collections.Generic;
<span style=color:#66d9ef>using</span> System.IO;
<span style=color:#66d9ef>using</span> System.Net;
<span style=color:#66d9ef>using</span> System.Net.Sockets;
<span style=color:#66d9ef>using</span> System.Text;
<span style=color:#66d9ef>using</span> System.Threading.Tasks;
<span style=color:#66d9ef>using</span> uhttpsharp;
<span style=color:#66d9ef>using</span> uhttpsharp.Handlers;
<span style=color:#66d9ef>using</span> uhttpsharp.Headers;
<span style=color:#66d9ef>using</span> uhttpsharp.Listeners;
<span style=color:#66d9ef>using</span> uhttpsharp.RequestProviders;
<span style=color:#66d9ef>using</span> WampSharp.V2;
<span style=color:#66d9ef>using</span> WampSharp.V2.Authentication;
<span style=color:#66d9ef>using</span> WampSharp.V2.Core.Contracts;
<span style=color:#66d9ef>using</span> WampSharp.V2.Realm;
<span style=color:#66d9ef>using</span> WampSharp.V2.Rpc;

<span style=color:#66d9ef>namespace</span> CookieDemo
{
    <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Program</span>
    {
        <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> Main(<span style=color:#66d9ef>string</span>[] args)
        {
            DefaultWampAuthenticationHost host =
                <span style=color:#66d9ef>new</span> DefaultWampAuthenticationHost(<span style=color:#e6db74>&#34;ws://0.0.0.0:8080/ws&#34;</span>,
                                                  <span style=color:#66d9ef>new</span> MyAuthenticationFactory(),
                                                  <span style=color:#66d9ef>new</span> MyCookieAuthenticatorFactory());

            IWampHostedRealm realm = host.RealmContainer.GetRealmByName(<span style=color:#e6db74>&#34;realm1&#34;</span>);

            realm.Services.RegisterCallee(<span style=color:#66d9ef>new</span> Calculator());

            host.Open();

            <span style=color:#66d9ef>using</span> (<span style=color:#66d9ef>var</span> httpServer = <span style=color:#66d9ef>new</span> HttpServer(<span style=color:#66d9ef>new</span> HttpRequestProvider()))
            {
                httpServer.Use(<span style=color:#66d9ef>new</span> TcpListenerAdapter(<span style=color:#66d9ef>new</span> TcpListener(IPAddress.Any, <span style=color:#ae81ff>80</span>)));

                httpServer.Use(<span style=color:#66d9ef>new</span> HttpRouter().With(<span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#66d9ef>new</span> FrontendHandler())
                                               .With(<span style=color:#e6db74>&#34;setcookie&#34;</span>, <span style=color:#66d9ef>new</span> CookieHandler()));

                httpServer.Use((context, next) =&gt; Task.Factory.GetCompleted());

                httpServer.Start();

                Console.ReadLine();
            }
        }
    }

    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Calculator</span>
    {
<span style=color:#a6e22e>        [WampProcedure(&#34;com.arguments.add2&#34;)]</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Add2(<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y)
        {
            <span style=color:#66d9ef>return</span> (x + y);
        }
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>        [WampProcedure(&#34;com.arguments.mul2&#34;)]</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Mul2(<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y)
        {
            <span style=color:#66d9ef>return</span> (x * y);
        }
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>        [WampProcedure(&#34;com.arguments.sub2&#34;)]</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Sub2(<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y)
        {
            <span style=color:#66d9ef>return</span> (x - y);
        }
<span style=color:#a6e22e>
</span><span style=color:#a6e22e>        [WampProcedure(&#34;com.arguments.div2&#34;)]</span>
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> Div2(<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y)
        {
            <span style=color:#66d9ef>return</span> (x / y);
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyCookieAuthenticatorFactory</span> : ICookieAuthenticatorFactory
    {
        <span style=color:#66d9ef>public</span> IWampSessionAuthenticator CreateAuthenticator(ICookieProvider cookieProvider)
        {
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> MyCookieAuthenticator(cookieProvider);
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyCookieAuthenticator</span> : WampSessionAuthenticator
    {
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> ICookieProvider mCookieProvider;

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> IDictionary&lt;<span style=color:#66d9ef>string</span>, IWampAuthorizer&gt; mBeetleToAuthorizers =
            <span style=color:#66d9ef>new</span> Dictionary&lt;<span style=color:#66d9ef>string</span>, IWampAuthorizer&gt;()
            {
<span style=color:#a6e22e>                [&#34;John&#34;]</span> =
                    <span style=color:#66d9ef>new</span> WampStaticAuthorizer(<span style=color:#66d9ef>new</span> List&lt;WampUriPermissions&gt;()
                    {
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.add2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        }
                    }),
<span style=color:#a6e22e>                [&#34;Ringo&#34;]</span> =
                    <span style=color:#66d9ef>new</span> WampStaticAuthorizer(<span style=color:#66d9ef>new</span> List&lt;WampUriPermissions&gt;()
                    {
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.add2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        },
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.mul2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        }
                    }),
<span style=color:#a6e22e>                [&#34;Paul&#34;]</span> =
                    <span style=color:#66d9ef>new</span> WampStaticAuthorizer(<span style=color:#66d9ef>new</span> List&lt;WampUriPermissions&gt;()
                    {
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.sub2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        },
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.div2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        }
                    }),
<span style=color:#a6e22e>                [&#34;George&#34;]</span> =
                    <span style=color:#66d9ef>new</span> WampStaticAuthorizer(<span style=color:#66d9ef>new</span> List&lt;WampUriPermissions&gt;()
                    {
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.add2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        },
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.mul2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        },
                        <span style=color:#66d9ef>new</span> WampUriPermissions()
                        {
                            Uri = <span style=color:#e6db74>&#34;com.arguments.sub2&#34;</span>,
                            CanCall = <span style=color:#66d9ef>true</span>
                        }
                    })
            };

        <span style=color:#66d9ef>public</span> MyCookieAuthenticator(ICookieProvider cookieProvider)
        {
            mCookieProvider = cookieProvider;

            Cookie cookie = mCookieProvider.GetCookieByName(<span style=color:#e6db74>&#34;beetle&#34;</span>);

            <span style=color:#66d9ef>if</span> (cookie != <span style=color:#66d9ef>null</span>)
            {
                Beetle = cookie.Value;
                <span style=color:#66d9ef>this</span>.Authorizer = mBeetleToAuthorizers[Beetle];
                IsAuthenticated = <span style=color:#66d9ef>true</span>;
            }
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>void</span> Authenticate(<span style=color:#66d9ef>string</span> signature, AuthenticateExtraData extra)
        {
            <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> WampAuthenticationException(<span style=color:#e6db74>&#34;Cookie wasn&#39;t present&#34;</span>);
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> Beetle { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> AuthenticationId
        {
            <span style=color:#66d9ef>get</span>
            {
                <span style=color:#66d9ef>return</span> Beetle;
            }
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> AuthenticationMethod
        {
            <span style=color:#66d9ef>get</span>
            {
                <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;cookie&#34;</span>;
            }
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyAuthenticationFactory</span> : IWampSessionAuthenticatorFactory
    {
        <span style=color:#66d9ef>public</span> IWampSessionAuthenticator GetSessionAuthenticator
            (WampPendingClientDetails details,
             IWampSessionAuthenticator transportAuthenticator)
        {
            <span style=color:#66d9ef>if</span> (!transportAuthenticator.IsAuthenticated)
            {
                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> WampAuthenticationException(<span style=color:#e6db74>&#34;Cookie wasn&#39;t present&#34;</span>);
            }

            <span style=color:#66d9ef>return</span> transportAuthenticator;
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HtmlHandler</span> : IHttpRequestHandler
    {
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> HttpResponse mResponse;
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> HttpResponse mKeepAliveResponse;

        <span style=color:#66d9ef>public</span> HtmlHandler(<span style=color:#66d9ef>string</span> contents)
        {
            MemoryStream memoryStream = <span style=color:#66d9ef>new</span> MemoryStream(Encoding.UTF8.GetBytes(contents));

            mKeepAliveResponse = <span style=color:#66d9ef>new</span> HttpResponse(HttpResponseCode.Ok, <span style=color:#e6db74>&#34;text/html&#34;</span>,
                                                  memoryStream,
                                                  <span style=color:#66d9ef>true</span>);

            mResponse = <span style=color:#66d9ef>new</span> HttpResponse(HttpResponseCode.Ok, <span style=color:#e6db74>&#34;text/html&#34;</span>,
                                         memoryStream,
                                         <span style=color:#66d9ef>false</span>);
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>virtual</span> Task Handle(IHttpContext context, Func&lt;Task&gt; next)
        {
            context.Response = context.Request.Headers.KeepAliveConnection()
                ? mKeepAliveResponse
                : mResponse;

            <span style=color:#66d9ef>return</span> Task.Factory.GetCompleted();
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FrontendHandler</span> : HtmlHandler
    {
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> TemplateHtml = <span style=color:#e6db74>@&#34;&lt;!DOCTYPE html&gt;
</span><span style=color:#e6db74>&lt;html&gt;
</span><span style=color:#e6db74>&lt;body&gt;
</span><span style=color:#e6db74>    &lt;h1&gt;Cookie authentication frontend&lt;/h1&gt;
</span><span style=color:#e6db74>    &lt;p&gt;Open JavaScript console to watch output.&lt;/p&gt;
</span><span style=color:#e6db74>    &lt;p&gt;&lt;a href=&#34;&#34;http://{0}/setcookie&#34;&#34;&gt;Set cookie.&lt;/a&gt;&lt;/p&gt;
</span><span style=color:#e6db74>    &lt;script src=&#34;&#34;https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz&#34;&#34;&gt;&lt;/script&gt;
</span><span style=color:#e6db74>    &lt;script type=&#34;&#34;text/javascript&#34;&#34;&gt;
</span><span style=color:#e6db74>        var connection = new autobahn.Connection({{
</span><span style=color:#e6db74>            url: &#39;ws://{0}:8080/ws&#39;,
</span><span style=color:#e6db74>            realm: &#39;realm1&#39;
</span><span style=color:#e6db74>        }});
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>        connection.onopen = function (session) {{
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>            session.call(&#39;com.arguments.add2&#39;, [2, 3]).then(
</span><span style=color:#e6db74>                function (res) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Add2:&#34;&#34;, res);
</span><span style=color:#e6db74>                }},
</span><span style=color:#e6db74>                function (err) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Add2 Error:&#34;&#34;, err.error, err.args, err.kwargs);
</span><span style=color:#e6db74>                }}
</span><span style=color:#e6db74>            );
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>            session.call(&#39;com.arguments.mul2&#39;, [5, 6]).then(
</span><span style=color:#e6db74>                function (res) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Mul2:&#34;&#34;, res);
</span><span style=color:#e6db74>                }},
</span><span style=color:#e6db74>                function (err) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Mul2 Error:&#34;&#34;, err.error, err.args, err.kwargs);
</span><span style=color:#e6db74>                }}
</span><span style=color:#e6db74>            );
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>            session.call(&#39;com.arguments.sub2&#39;, [1, 9]).then(
</span><span style=color:#e6db74>                function (res) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Sub2:&#34;&#34;, res);
</span><span style=color:#e6db74>                }},
</span><span style=color:#e6db74>                function (err) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Sub2 Error:&#34;&#34;, err.error, err.args, err.kwargs);
</span><span style=color:#e6db74>                }}
</span><span style=color:#e6db74>            );
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>            session.call(&#39;com.arguments.div2&#39;, [10, 4]).then(
</span><span style=color:#e6db74>                function (res) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Div2:&#34;&#34;, res);
</span><span style=color:#e6db74>                }},
</span><span style=color:#e6db74>                function (err) {{
</span><span style=color:#e6db74>                    console.log(&#34;&#34;Div2 Error:&#34;&#34;, err.error, err.args, err.kwargs);
</span><span style=color:#e6db74>                }}
</span><span style=color:#e6db74>            );
</span><span style=color:#e6db74>        }};
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>        connection.open();
</span><span style=color:#e6db74>    &lt;/script&gt;
</span><span style=color:#e6db74>&lt;/body&gt;
</span><span style=color:#e6db74>&lt;/html&gt;&#34;</span>;

        <span style=color:#66d9ef>public</span> FrontendHandler() : <span style=color:#66d9ef>base</span>(<span style=color:#66d9ef>string</span>.Format(TemplateHtml, Environment.MachineName))
        {
        }
    }

    <span style=color:#66d9ef>internal</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CookieHandler</span> : HtmlHandler
    {
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>readonly</span> <span style=color:#66d9ef>string</span>[] mNames = <span style=color:#66d9ef>new</span>[] {<span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Paul&#34;</span>, <span style=color:#e6db74>&#34;George&#34;</span>, <span style=color:#e6db74>&#34;Ringo&#34;</span>};

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> Random mRandom = <span style=color:#66d9ef>new</span> Random();
        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> <span style=color:#66d9ef>object</span> mLock = <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>object</span>();

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>const</span> <span style=color:#66d9ef>string</span> HtmlTemplate = <span style=color:#e6db74>@&#34;&lt;!DOCTYPE html&gt;
</span><span style=color:#e6db74>&lt;html&gt;
</span><span style=color:#e6db74>&lt;body&gt;
</span><span style=color:#e6db74>    &lt;h1&gt;Cookie authentication frontend&lt;/h1&gt;
</span><span style=color:#e6db74>    &lt;p&gt;Cookie set! visit &lt;a href=&#34;&#34;/&#34;&#34;&gt;home&lt;/a&gt;&lt;/p&gt;.
</span><span style=color:#e6db74>&lt;/body&gt;
</span><span style=color:#e6db74>&lt;/html&gt;&#34;</span>;

        <span style=color:#66d9ef>public</span> CookieHandler() : <span style=color:#66d9ef>base</span>(HtmlTemplate)
        {
        }

        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> Task Handle(IHttpContext context, Func&lt;Task&gt; next)
        {
            context.Cookies.Upsert(<span style=color:#e6db74>&#34;beetle&#34;</span>, GetBeetleName());
            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.Handle(context, next);
        }

        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>string</span> GetBeetleName()
        {
            <span style=color:#66d9ef>int</span> random;

            <span style=color:#66d9ef>lock</span> (mLock)
            {
                random = mRandom.Next(mNames.Length);
            }

            <span style=color:#66d9ef>return</span> mNames[random];
        }
    }
}
</code></pre></div></section></article></main></div><div class="col-sm-3 col-sm-offset-1 doc-sidebar"><div id=sidebar><div class=sidebar-module><div class=sidebar-toc><h4 class=sidebar-heading>Table of Contents</h4><ul><li><strong><a href=#title>Cookie based router-side authentication</a></strong></li></ul><nav id=TableOfContents><ul><li><a href=#example>Example</a></li></ul></nav></div></div><div class=sidebar-module><h4 class=sidebar-heading>Pages in Categories</h4><ul class=sidebar-category-list><li><a href=https://wampsharp.net/categories/authentication><span class=doc-list-category>Authentication</span></a><ul><li><a href=/wamp2/client/client-side-authentication/>Client-side authentication</a></li><li><span class=active>Cookie based router-side authentication</span></li><li><a href=/wamp2/router/router-side-authentication/>Router-side authentication</a></li><li><a href=/wamp2/client/wamp-cra-client-side-authentication/>WAMP-CRA client side authentication</a></li><li><a href=/wamp2/router/wamp-cra-router-side-authentication/>WAMP-CRA router-side authentication</a></li></ul></li><li><a href=https://wampsharp.net/categories/callee><span class=doc-list-category>Callee</span></a><ul><li><a href=/wamp2/roles/callee/getting-started-with-callee/>Getting started with Callee</a></li><li><a href=/wamp2/roles/callee/raw-callee/>Raw Callee</a></li><li><a href=/wamp2/roles/callee/reflection-based-callee/>Reflection-based Callee</a></li></ul></li><li><a href=https://wampsharp.net/categories/caller><span class=doc-list-category>Caller</span></a><ul><li><a href=/wamp2/roles/caller/getting-started-with-caller/>Getting started with Caller</a></li><li><a href=/wamp2/roles/caller/raw-caller/>Raw Caller</a></li><li><a href=/wamp2/roles/caller/reflection-based-caller/>Reflection-based Caller</a></li></ul></li><li><a href=https://wampsharp.net/categories/client><span class=doc-list-category>Client</span></a><ul><li><a href=/wamp2/router/transports/rawsocket/>RawSocket transport</a></li><li><a href=/wamp2/client/client-side-authentication/>Client-side authentication</a></li><li><a href=/wamp2/meta-api-service/>Meta-api descriptor service</a></li><li><a href=/wamp2/testament-service/>Testament service</a></li><li><a href=/wamp2/client/wamp-cra-client-side-authentication/>WAMP-CRA client side authentication</a></li><li><a href=/wamp2/client/wampchannel/>WampChannel</a></li><li><a href=/wamp2/client/wampchannelreconnector/>WampChannelReconnector</a></li></ul></li><li><a href=https://wampsharp.net/categories/getting-started><span class=doc-list-category>Getting-Started</span></a><ul><li><a href=/wamp2/roles/callee/getting-started-with-callee/>Getting started with Callee</a></li><li><a href=/wamp2/roles/caller/getting-started-with-caller/>Getting started with Caller</a></li><li><a href=/wamp2/roles/publisher/getting-started-with-publisher/>Getting started with Publisher</a></li><li><a href=/wamp2/roles/subscriber/getting-started-with-subscriber/>Getting started with Subscriber</a></li><li><a href=/wamp2/getting-started-with-wampv2/>Getting started with WAMPv2</a></li></ul></li><li><a href=https://wampsharp.net/categories/publisher><span class=doc-list-category>Publisher</span></a><ul><li><a href=/wamp2/roles/publisher/getting-started-with-publisher/>Getting started with Publisher</a></li><li><a href=/wamp2/roles/publisher/raw-publisher/>Raw Publisher</a></li><li><a href=/wamp2/roles/publisher/reflection-based-publisher/>Reflection-based Publisher</a></li><li><a href=/wamp2/roles/publisher/rx-based-publisher/>Rx-based Publisher</a></li></ul></li><li><a href=https://wampsharp.net/categories/release-notes><span class=doc-list-category>Release-Notes</span></a><ul><li><a href=/release-notes/wampsharp-v20.1.1-release-notes/>WampSharp v20.1.1 release notes</a></li><li><a href=/release-notes/wampsharp-v18.6.1-release-notes/>WampSharp v18.6.1 release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.6.41-beta-release-notes/>WampSharp v1.2.6.41-beta release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.5.21-beta-release-notes/>WampSharp v1.2.5.21-beta release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.4.18-beta-release-notes/>WampSharp v1.2.4.18-beta release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.3.12-beta-release-notes/>WampSharp v1.2.3.12-beta release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.2.8-beta-release-notes/>WampSharp v1.2.2.8-beta release notes</a></li><li><a href=/release-notes/wampsharp-v1.2.1.6-beta-release-notes/>WampSharp v1.2.1.6-beta release notes</a></li></ul></li><li><a href=https://wampsharp.net/categories/roadmap><span class=doc-list-category>Roadmap</span></a><ul><li><a href=/roadmap/>Roadmap</a></li></ul></li><li><a href=https://wampsharp.net/categories/router><span class=doc-list-category>Router</span></a><ul><li><a href=/wamp2/router/transports/rawsocket/>RawSocket transport</a></li><li><a href=/wamp2/router/transports/websocket/>WebSocket transports</a></li><li><span class=active>Cookie based router-side authentication</span></li><li><a href=/wamp2/meta-api-service/>Meta-api descriptor service</a></li><li><a href=/wamp2/router/router-side-authentication/>Router-side authentication</a></li><li><a href=/wamp2/testament-service/>Testament service</a></li><li><a href=/wamp2/router/wamp-cra-router-side-authentication/>WAMP-CRA router-side authentication</a></li><li><a href=/wamp2/router/wamphost/>WampHost</a></li></ul></li><li><a href=https://wampsharp.net/categories/subscriber><span class=doc-list-category>Subscriber</span></a><ul><li><a href=/wamp2/roles/subscriber/getting-started-with-subscriber/>Getting started with Subscriber</a></li><li><a href=/wamp2/roles/subscriber/raw-subscriber/>Raw Subscriber</a></li><li><a href=/wamp2/roles/subscriber/reflection-based-subscriber/>Reflection-based Subscriber</a></li><li><a href=/wamp2/roles/subscriber/rx-based-subscriber/>Rx-based Subscriber</a></li></ul></li><li><a href=https://wampsharp.net/categories/wamp1><span class=doc-list-category>Wamp1</span></a><ul><li><a href=/wamp1/getting-started-with-wampv1/>Getting started with WAMPv1</a></li><li><a href=/wamp1/getting-started-with-wampv1-client/>Getting started with WAMPv1 client</a></li><li><a href=/wamp1/notes-for-wampv1-users/>Notes for WAMP1 users</a></li><li><a href=/wamp1/server-pubsub-hosting-wampv1/>Server PubSub hosting (WAMPv1)</a></li><li><a href=/wamp1/server-rpc-hosting-wampv1/>Server RPC hosting (WAMPv1)</a></li></ul></li></ul></div><div class=sidebar-module><h4 class=sidebar-heading>Tags</h4><div class=tag-box><a class=tag-item href=https://wampsharp.net/tags/authentication>authentication</a>
<a class=tag-item href=https://wampsharp.net/tags/callee>callee</a>
<a class=tag-item href=https://wampsharp.net/tags/caller>caller</a>
<a class=tag-item href=https://wampsharp.net/tags/client>client</a>
<a class=tag-item href=https://wampsharp.net/tags/publisher>publisher</a>
<a class=tag-item href=https://wampsharp.net/tags/raw-api>raw-api</a>
<a class=tag-item href=https://wampsharp.net/tags/reflection>reflection</a>
<a class=tag-item href=https://wampsharp.net/tags/roadmap>roadmap</a>
<a class=tag-item href=https://wampsharp.net/tags/router>router</a>
<a class=tag-item href=https://wampsharp.net/tags/rx>rx</a>
<a class=tag-item href=https://wampsharp.net/tags/services>services</a>
<a class=tag-item href=https://wampsharp.net/tags/subscriber>subscriber</a>
<a class=tag-item href=https://wampsharp.net/tags/transports>transports</a>
<a class=tag-item href=https://wampsharp.net/tags/wamp1>wamp1</a>
<a class=tag-item href=https://wampsharp.net/tags/wampcra>wampcra</a></div></div></div></div></div><hr><div class=row><div class=col-sm-8><p class=doc-footer-em><a href=# onclick=resetSidebarPos()>Back to TOP</a></p></div></div></div><footer class=doc-footer><p class=doc-footer-em>Browse <strong><a href=https://github.com/Code-Sharp/WampSharp.net/>Repository</a></strong></p><p>Copyright (c) 2013-2020, Elad Zelingher; All rights reserved.</p><p>Powered by <strong><a href=https://github.com/progrhyme/hugo-theme-bootie-docs>Bootie Docs</a></strong> - theme for <a href=http://gohugo.io/>Hugo</a> by <a href=https://github.com/progrhyme/>progrhyme</a>.</p></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-98663639-2','auto');ga('send','pageview');</script><script src=https://wampsharp.net/js/jquery.min.js></script><script src=https://wampsharp.net/js/bootstrap.min.js></script><script src=https://wampsharp.net/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=https://wampsharp.net/js/ie10-viewport-bug-workaround.js></script><script src=https://wampsharp.net/js/bootie-docs.js></script><script src=https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js></script><script>docsearch({apiKey:'0327efc17cad5f4c0585144de916a164',indexName:'wampsharp',inputSelector:'#as_q',debug:false,});</script></body></html>