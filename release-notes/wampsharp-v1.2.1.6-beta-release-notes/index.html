<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="alternate" href="/index.xml" type="application/rss+xml" title="WampSharp">
		<link rel="icon" href="http://wampsharp.net/favicon.ico">
		<title>WampSharp v1.2.1.6-beta release notes - WampSharp</title>
		
		<link rel="stylesheet" href="http://wampsharp.net/css/highlight/default.css">
		<link rel="stylesheet" href="http://wampsharp.net/css/bootstrap.min.css">
		<link rel="stylesheet" href="http://wampsharp.net/css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="http://wampsharp.net/css/theme.css">
		<link rel="stylesheet" href="http://wampsharp.net/css/bootie-docs.css">
		<link rel="stylesheet" href="http://wampsharp.net/css/site.css">
	</head>

<body role="document">

	
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="http://wampsharp.net/">WampSharp</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li ><a href="http://wampsharp.net/">Home</a></li>
			
			
				
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Categories<span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
						
							<li><a href="http://wampsharp.net/categories/authentication">Authentication</a></li>
						
							<li><a href="http://wampsharp.net/categories/callee">Callee</a></li>
						
							<li><a href="http://wampsharp.net/categories/caller">Caller</a></li>
						
							<li><a href="http://wampsharp.net/categories/client">Client</a></li>
						
							<li><a href="http://wampsharp.net/categories/getting-started">Getting-Started</a></li>
						
							<li><a href="http://wampsharp.net/categories/publisher">Publisher</a></li>
						
							<li><a href="http://wampsharp.net/categories/release-notes">Release-Notes</a></li>
						
							<li><a href="http://wampsharp.net/categories/roadmap">Roadmap</a></li>
						
							<li><a href="http://wampsharp.net/categories/router">Router</a></li>
						
							<li><a href="http://wampsharp.net/categories/subscriber">Subscriber</a></li>
						
							<li><a href="http://wampsharp.net/categories/wamp1">Wamp1</a></li>
						
						</ul>
					</li>
				
				</ul>
				
			</div>
		</div>
	</nav>

<div class="container">


<div class="row">
	<div class="col-sm-8 doc-main">
		<main role="main">
			<article>
				<a id="title"></a>
				<h1 class="doc-entry-title">WampSharp v1.2.1.6-beta release notes</h1>
				<div class="doc-entry-meta">
					<span><time datetime="2015-02-28">February 28, 2015</time></span>
				</div>
				<section>
					

<h2 id="api-changes">Api changes</h2>

<h3 id="iasyncdisposable">IAsyncDisposable</h3>

<p>A new type called IAsyncDisposable is introduced in the library. It&rsquo;s similar to IDisposable, but returns a Task.</p>

<pre><code class="language-csharp">public interface IAsyncDisposable
{
    Task DisposeAsync();
}
</code></pre>

<p>Task&lt;IAsyncDisposable&gt; is returned from some methods:</p>

<ul>
<li>IWampTopicProxy Subscribe method now returns an Task&lt;IAsyncDisposable&gt; instead of Task&lt;IDisposable&gt;, you can call DisposeAsync in order to unsubscribe from the topic.</li>
<li>IWampRpcOperationCatalogProxy Register method now returns Task&lt;IAsyncDisposable&gt; instead of Task. Call DisposeAsync to Unregister the procedure from router.</li>
<li>IWampRpcOperationCatalogProxy Unregister method has been removed. Use the IAsyncDisposable returned from Register instead.</li>
<li>IWampRealmServiceProvider Register method now returns a Task&lt;IAsyncDisposable&gt;, call DisposeAsync in order to unregister the callee.</li>
</ul>

<p>The IAsyncDisposable mentioned above&rsquo;s Task completes when the router sends a UNSUBSCRIBED/UNREGISTERED message corresponding to the sent request.</p>

<h3 id="other-changes">Other changes</h3>

<ul>
<li>SubscriptionRemoveEventArgs renamed to WampSubscriptionRemoveEventArgs.</li>
<li>WampConnectionBrokenException moved to namespace WampSharp.V2.Core.Contracts.</li>
</ul>

<h2 id="new-features">New features</h2>

<h3 id="vtortola-websocketlistener-support">vtortola.WebSocketListener support</h3>

<p>This version has support for <a href="http://www.github.com/vtortola/WebSocketListener">vtortola.WebSocketListener</a>. In order to use it, install the WampSharp.Vtortola package. Then create a WampHost and register the VtortolaWebSocketTransport:</p>

<pre><code class="language-csharp">WampHost host = new WampHost();

IWampTransport transport =
    new VtortolaWebSocketTransport
        (endpoint: new IPEndPoint(IPAddress.Parse(&quot;127.0.0.1&quot;), 8080),
            perMessageDeflate: true);

host.RegisterTransport(transport,
    new JTokenJsonBinding(),
    new JTokenMsgpackBinding());

host.Open();
</code></pre>

<p>This listener supports <a href="http://tools.ietf.org/html/draft-ietf-hybi-permessage-compression-17#section-8">per message deflate</a>. To enable it, pass perMessageDeflate = true, in the transport&rsquo;s ctor.</p>

<h3 id="rawsocket-transport-support">RawSocket transport support</h3>

<p>This version has router-side only support for <a href="https://github.com/wamp-proto/wamp-proto/blob/BEFORE_REPLACE_SPEC_WITH_RFC/spec/advanced.md#rawsocket-transport">RawSocket transport</a>. In order to use it, install the WampSharp.RawSocket package. Then create a WampHost and register the RawSocketTransport.
Example:</p>

<pre><code class="language-csharp">WampHost host = new WampHost();

IWampTransport transport =
    new RawSocketTransport(&quot;127.0.0.1&quot;, 8080);

host.RegisterTransport(transport,
    new JTokenMsgpackBinding());

host.Open();
</code></pre>

<blockquote>
<p>Note: There are a few issues currently with the SuperSocket dependency. After Installing WampSharp.RawSocketTransport, add manually a reference of SuperSocket.SocketEngine.dll (located in $(SolutionDir)\packages\SuperSocket\SuperSocket.SocketEngine.dll) to your project.</p>

<p>Note: The current implemented version of RawSocket protocol is the original version (before revision). This is the version also implemented by AutobahnPython/AutobahnCpp clients.</p>
</blockquote>

<h3 id="progressive-calls">Progressive calls</h3>

<p>From this version, progressive calls are supported.
In order to use progressive calls as a Caller, declare in your callee service a [WampProcedure] method having a [WampProgressiveCall] attribute and a IProgress&lt;T&gt; as the last parameter.
&gt; Note that the method return type should be Task&lt;T&gt; where this is the same T as in the IProgress&lt;T&gt; of the last parameter.</p>

<p>Example:</p>

<pre><code class="language-csharp">public interface ILongOpService
{
    [WampProcedure(&quot;com.myapp.longop&quot;)]
    [WampProgressiveResultProcedure]
    Task&lt;int&gt; LongOp(int n, IProgress&lt;int&gt; progress);
}
</code></pre>

<p>Then obtain the proxy and call it:</p>

<pre><code class="language-csharp">public async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel = factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    ILongOpService proxy = channel.RealmProxy.Services.GetCalleeProxy&lt;ILongOpService&gt;();

    Progress&lt;int&gt; progress =
        new Progress&lt;int&gt;(i =&gt; Console.WriteLine(&quot;Got progress &quot; + i));

    int result = await proxy.LongOp(10, progress);

    Console.WriteLine(&quot;Got result &quot; + result);
}
</code></pre>

<p>In order to use progressive calls as a Callee, create a service with that implements an interface with the same kind of signature. In order to report progress, call the progress Report method. Example:</p>

<pre><code class="language-csharp">public class LongOpService : ILongOpService
{
    public async Task&lt;int&gt; LongOp(int n, IProgress&lt;int&gt; progress)
    {
        for (int i = 0; i &lt; n; i++)
        {
            progress.Report(i);
            await Task.Delay(100);
        }

        return n;
    }
}
</code></pre>

<blockquote>
<p>Note: you can put the attributes on the method itself instead of implementing an interface, i.e:</p>

<pre><code class="language-csharp"> public class LongOpService
{
    [WampProcedure(&quot;com.myapp.longop&quot;)]
    [WampProgressiveResultProcedure]
    public async Task&lt;int&gt; LongOp(int n, IProgress&lt;int&gt; progress)
    {
        // ...
    }
 }
</code></pre>

<p>Then register it to the realm regularly:</p>

<pre><code class="language-csharp">public async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel = factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    ILongOpService service = new LongOpService();

    IAsyncDisposable disposable =
        await channel.RealmProxy.Services.RegisterCallee(service);

    Console.WriteLine(&quot;Registered LongOpService&quot;);
}
</code></pre>

<p>Note:  The samples are based on <a href="https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/wamp/rpc/progress">this</a> AutobahnJS sample</p>
</blockquote>

<h3 id="caller-identification">Caller identification</h3>

<p>From this version, it is possible to get/supply caller identification details. According to WAMP2 specification, a Callee can request to get caller identification details (by specifying disclose_caller = true on registration), and a Caller can request to disclose its identification (by specifying disclose_me = true on call request).</p>

<p>Specifying these is now possible on callee registration and when obtaining callee proxy:</p>

<p>Callee registration example:</p>

<pre><code class="language-csharp">public async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel =
        factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    SquareService service = new SquareService();

    var registerOptions =
        new RegisterOptions
        {
            DiscloseCaller = true
        };

    IAsyncDisposable disposable =
        await channel.RealmProxy.Services.RegisterCallee(service,
            new CalleeRegistrationInterceptor(registerOptions));
}
</code></pre>

<p>Callee proxy sample:</p>

<pre><code class="language-csharp">public async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel =
        factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    var callOptions = new CallOptions()
    {
        DiscloseMe = true
    };

    ISquareService proxy =
        channel.RealmProxy.Services.GetCalleeProxy&lt;ISquareService&gt;
        (new CachedCalleeProxyInterceptor(new CalleeProxyInterceptor(callOptions)));

    await proxy.Square(-2);
    await proxy.Square(0);
    await proxy.Square(2);
}

</code></pre>

<p>In order to obtain these details as a Callee (using reflection api), access WampInvocationContext.Current.</p>

<p>Sample:</p>

<pre><code class="language-csharp">public class SquareService
{
    [WampProcedure(&quot;com.myapp.square&quot;)]
    public int Square(int n)
    {
        InvocationDetails details =
            WampInvocationContext.Current.InvocationDetails;

        Console.WriteLine(&quot;Someone is calling me: &quot; + details.Caller);

        return n*n;
    }
}

</code></pre>

<blockquote>
<p>Note: The samples are based on <a href="https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/wamp/rpc/options">this</a> AutobahnJS sample</p>
</blockquote>

<h3 id="wampinvocationcontext">WampInvocationContext</h3>

<p>WampInvocationContext allows you to get the invocation details provided with the current invocation. It currently contains the caller identification (if present) and whether the caller requested a progressive call.
Example:</p>

<pre><code class="language-csharp">public class LongOpService : ILongOpService
{
    public async Task&lt;int&gt; LongOp(int n, IProgress&lt;int&gt; progress)
    {
        InvocationDetails details =
            WampInvocationContext.Current.InvocationDetails;

        for (int i = 0; i &lt; n; i++)
        {
            if (details.ReceiveProgress == true)
            {
                progress.Report(i);                    
            }

            await Task.Delay(100);
        }

        return n;
    }
}
</code></pre>

<h3 id="attribute-based-pub-sub">Attribute based pub/sub</h3>

<p>Allows to use WAMPv2 pub/sub features in a similar fashion as reflection rpc.</p>

<p>In order to use it from a publisher, create a class containing an event decorated with a [WampTopic] attribute. Then register an instance of the class using the RegisterPublisher method of IWampRealmServiceProvider. The arguments published to the event will be treated as the arguments keywords of the publication.</p>

<p>Example: Publisher class:</p>

<pre><code class="language-csharp">public class MyClass
{
    [JsonProperty(&quot;counter&quot;)]
    public int Counter { get; set; }

    [JsonProperty(&quot;foo&quot;)]
    public int[] Foo { get; set; }
}

public delegate void MyPublicationDelegate(int number1, int number2, string c, MyClass d);

public interface IMyPublisher
{
    [WampTopic(&quot;com.myapp.heartbeat&quot;)]
    event Action Heartbeat;

    [WampTopic(&quot;com.myapp.topic2&quot;)]
    event MyPublicationDelegate MyEvent;
}

public class MyPublisher : IMyPublisher
{
    private readonly Random mRandom = new Random();
    private IDisposable mSubscription;

    public MyPublisher()
    {
        mSubscription = Observable.Timer(TimeSpan.FromSeconds(0),
            TimeSpan.FromSeconds(1)).Select((x, i) =&gt; i)
            .Subscribe(x =&gt; OnTimer(x));
    }

    private void OnTimer(int value)
    {
        RaiseHeartbeat();

        RaiseMyEvent(mRandom.Next(0, 100),
            23,
            &quot;Hello&quot;,
            new MyClass()
            {
                Counter = value,
                Foo = new int[] {1, 2, 3}
            });
    }

    private void RaiseHeartbeat()
    {
        Action handler = Heartbeat;

        if (handler != null)
        {
            handler();
        }
    }

    private void RaiseMyEvent(int number1, int number2, string c, MyClass d)
    {
        MyPublicationDelegate handler = MyEvent;

        if (handler != null)
        {
            handler(number1, number2, c, d);
        }
    }

    public event Action Heartbeat;

    public event MyPublicationDelegate MyEvent;
}
</code></pre>

<p>Publisher registration:</p>

<pre><code class="language-csharp">public static async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel =
        factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    IDisposable publisherDisposable =
        channel.RealmProxy.Services.RegisterPublisher(new MyPublisher());

    // call publisherDisposable.Dispose(); to unsubscribe from the event.
}
</code></pre>

<blockquote>
<p>Note: if the delegate used is of any Action&lt;&gt; type, the publication will send the parameters as the positional arguments of the publication, otherwise it will use the parameters as the keyword arguments of the publication (with the delegate parameters&rsquo; names as the keys).</p>
</blockquote>

<p>In order to use the feature from a subscriber, create a class with a method having a [WampTopic] attribute, Then call RegisterSubscriber of IWampRealmServiceProvider.</p>

<p>Example:</p>

<pre><code class="language-csharp">public class MyClass
{
    [JsonProperty(&quot;counter&quot;)]
    public int Counter { get; set; }

    [JsonProperty(&quot;foo&quot;)]
    public int[] Foo { get; set; }

    public override string ToString()
    {
        return string.Format(&quot;counter: {0}, foo: [{1}]&quot;,
            Counter,
            string.Join(&quot;, &quot;, Foo));
    }
}

public interface IMySubscriber
{
    [WampTopic(&quot;com.myapp.heartbeat&quot;)]
    void OnHeartbeat();

    [WampTopic(&quot;com.myapp.topic2&quot;)]
    void OnTopic2(int number1, int number2, string c, MyClass d);
}

public class MySubscriber : IMySubscriber
{
    public void OnHeartbeat()
    {
        long publicationId = WampEventContext.Current.PublicationId;
        Console.WriteLine(&quot;Got heartbeat (publication ID &quot; + publicationId + &quot;)&quot;);
    }

    public void OnTopic2(int number1, int number2, string c, MyClass d)
    {
        Console.WriteLine(&quot;Got event: number1:{0}, number2:{1}, c:{2}, d:{3}&quot;,
            number1, number2, c, d);
    }
}
</code></pre>

<p>Subscriber registration:</p>

<pre><code class="language-csharp">public static async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel =
        factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    Task&lt;IAsyncDisposable&gt; subscriptionTask =
        channel.RealmProxy.Services.RegisterSubscriber(new MySubscriber());

    IAsyncDisposable asyncDisposable = await subscriptionTask;

    // call await asyncDisposable.DisposeAsync(); to unsubscribe from the topic.
}

</code></pre>

<blockquote>
<p>Note:  The samples are based on <a href="https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/wamp/pubsub/complex">this</a> AutobahnJS sample, but are a bit different (WampSharp doesn&rsquo;t support publishing both positional arguments and keyword arguments with this feature)</p>
</blockquote>

<h3 id="wampeventcontext">WampEventContext</h3>

<p>As illustrated in last sample, you can use in pub/sub based subscribers WampEventContext.Current in order to get details about the current received event:</p>

<pre><code class="language-csharp">public class MySubscriber
{
    [WampTopic(&quot;com.myapp.topic1&quot;)]
    public void OnTopic1(int counter)
    {
        WampEventContext context = WampEventContext.Current;

        Console.WriteLine(&quot;Got event, publication ID {0}, publisher {1}: {2}&quot;,
            context.PublicationId,
            context.EventDetails.Publisher,
            counter);
    }
}
</code></pre>

<blockquote>
<p>Note:  The sample is based on <a href="https://github.com/tavendo/AutobahnPython/tree/master/examples/twisted/wamp/pubsub/options">this</a> AutobahnJS sample.</p>
</blockquote>

<h3 id="registration-customization">Registration customization</h3>

<p>The RegisterCallee, GetCalleeProxy, RegisterSubscriber and RegisterPublisher methods of IWampRealmServiceProvider now all have overloads that receive an &ldquo;interceptor&rdquo; instance. The &ldquo;interceptors&rdquo; allow customizing the request being performed.</p>

<p>For instance, assume you want to call procedures of a contract that its procedures uris are known only on runtime.  This is possible implementing a ICalleeProxyInterceptor:</p>

<pre><code class="language-csharp">public class MyCalleeProxyInterceptor : CalleeProxyInterceptor
{
    private readonly int mCalleeIndex;

    public MyCalleeProxyInterceptor(int calleeIndex) :
        base(new CallOptions())
    {
        mCalleeIndex = calleeIndex;
    }

    public override string GetProcedureUri(MethodInfo method)
    {
        string format = base.GetProcedureUri(method);
        string result = string.Format(format, mCalleeIndex);
        return result;
    }
}

</code></pre>

<p>This interceptor modifies the procedure uri of the procedure to call. For example, we can declare an interface with a method with this signature:</p>

<pre><code class="language-csharp">public interface ISquareService
{
    [WampProcedure(&quot;com.myapp.square.{0}&quot;)]
    Task&lt;int&gt; Square(int number);
}
</code></pre>

<p>And then specify the index in runtime:</p>

<pre><code class="language-csharp">public static async Task Run()
{
    DefaultWampChannelFactory factory = new DefaultWampChannelFactory();

    IWampChannel channel =
        factory.CreateJsonChannel(&quot;ws://localhost:8080/ws&quot;, &quot;realm1&quot;);

    await channel.Open();

    int index = GetRuntimeIndex();

    ISquareService proxy =
        channel.RealmProxy.Services.GetCalleeProxy&lt;ISquareService&gt;
        (new CachedCalleeProxyInterceptor(
            new MyCalleeProxyInterceptor(index)));

    int nine = await proxy.Square(3); // Calls (&quot;com.myapp.square.&quot; + index)
}

</code></pre>

<blockquote>
<p>Note: we wrap our interceptor with the CachedCalleeProxyInterceptor in order to cache the results of our interceptor, in order to avoid calculating them each call.</p>
</blockquote>

<p>Other interceptors work similarly.
In addition, the interceptors allow modifying the options sent to each request.</p>

<blockquote>
<p>Note: these interceptors are still &ldquo;static&rdquo;, i.e: they don&rsquo;t allow returning a value that depends on the publication/call parameters.</p>
</blockquote>

<h3 id="authentication">Authentication</h3>

<p>Client-side authentication is now supported. In order to use client authentication, you need to implement an interface named IWampClientAuthenticator. Then, pass it to CreateChannel/CreateJsonChannel/CreateMsgpackChannel overloads of DefaultChannelFactory.
In IWampClientAuthenticator we supply the supported authentication methods and the authenticationid, these are passed in the HELLO message to the router (as details.authmethods, details.authid). We also implement Authenticate method, which sends an AUTHENTICATE message to the router upon CHALLENGE.</p>

<p>Example:</p>

<pre><code class="language-csharp">public class TicketAuthenticator : IWampClientAuthenticator
{
    private static readonly string[] mAuthenticationMethods = { &quot;ticket&quot; };

    private readonly IDictionary&lt;string, string&gt; mTickets =
        new Dictionary&lt;string, string&gt;()
        {
            {&quot;peter&quot;, &quot;magic_secret_1&quot;},
            {&quot;joe&quot;, &quot;magic_secret_2&quot;}
        };

    private const string User = &quot;peter&quot;;

    public AuthenticationResponse Authenticate(string authmethod, ChallengeDetails extra)
    {
        if (authmethod == &quot;ticket&quot;)
        {
            Console.WriteLine(&quot;authenticating via '&quot; + authmethod + &quot;'&quot;);

            AuthenticationResponse result =
                new AuthenticationResponse {Signature = mTickets[User]};

            return result;
        }
        else
        {
            throw new WampAuthenticationException(&quot;don't know how to authenticate using '&quot; + authmethod + &quot;'&quot;);
        }
    }

    public string[] AuthenticationMethods
    {
        get
        {
            return mAuthenticationMethods;
        }
    }

    public string AuthenticationId
    {
        get
        {
            return User;
        }
    }
}
</code></pre>

<p>Then we pass an instance of our authenticator to the ChannelFactory:</p>

<pre><code class="language-csharp">public async Task Run()
{
    DefaultWampChannelFactory channelFactory = new DefaultWampChannelFactory();

    IWampClientAuthenticator authenticator = new TicketAuthenticator();

    IWampChannel channel =
        channelFactory.CreateJsonChannel(&quot;ws://127.0.0.1:8080/ws&quot;,
            &quot;realm1&quot;,
            authenticator);

    IWampRealmProxy realmProxy = channel.RealmProxy;

    await channel.Open();

    // Call a rpc for example
    ITimeService proxy = realmProxy.Services.GetCalleeProxy&lt;ITimeService&gt;();

    try
    {
        string now = await proxy.Now();
        Console.WriteLine(&quot;call result {0}&quot;, now);
    }
    catch (Exception e)
    {
        Console.WriteLine(&quot;call error {0}&quot;, e);
    }
}
</code></pre>

<blockquote>
<p>Note:  The sample is based on <a href="https://github.com/crossbario/crossbar-examples/tree/master/authentication/ticket">this</a> AutobahnJS sample</p>
</blockquote>

<h2 id="internal-changes">Internal Changes</h2>

<h3 id="router-iwamprealmserviceprovider">Router IWampRealmServiceProvider</h3>

<p>From this version, WampHost&rsquo;s Realms&rsquo; Service property is implemented differently - it is implemented as a WAMP client with in-memory transport. That means that the WampHost communicates with the IWampRealmServiceProvider using &ldquo;serialization&rdquo;, which adds a bit overhead. There are a couple of reasons for this change:</p>

<ul>
<li>This allows me to reuse code, instead of maintaining two different implementations of IWampRealmServiceProvider - one for the router and one for the client.</li>
<li>It makes the router hosted components first class citizens - each realm internal client has now a session id (available via IHostedRealm.SessionId).</li>
<li>It makes the code more consistent - whether if it runs in the router or as a client.</li>
<li>WAMPv2 <a href="https://github.com/wamp-proto/wamp-proto/tree/BEFORE_REPLACE_SPEC_WITH_RFC/spec/basic.md#application-code">discourages</a> routers to run application code.</li>
</ul>

<h3 id="fleck-transport">Fleck transport</h3>

<p>From this version, Fleck 0.12.0.40 is used. This version of Fleck has feedback for message send to clients. WampSharp uses this feedback and assures that messages are sent serially per client - i.e:  a message will only be sent after the previous one has been received by the client. This should avoid some race conditions and should implement <a href="https://github.com/wamp-proto/wamp-proto/tree/BEFORE_REPLACE_SPEC_WITH_RFC/spec/basic.md#ordering-guarantees">ordering-guarantees</a> better.</p>

				</section>
			</article>
		</main>
	</div> 

	

<div class="col-sm-3 col-sm-offset-1 doc-sidebar">
	<div id="sidebar">
	<div class="sidebar-module">
		<div class="sidebar-toc">
			<h4 class="sidebar-heading">Table of Contents</h4>
			<ul>
				<li><strong><a href="#title">WampSharp v1.2.1.6-beta release notes</a></strong></li>
			</ul>
			<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#api-changes">Api changes</a>
<ul>
<li><a href="#iasyncdisposable">IAsyncDisposable</a></li>
<li><a href="#other-changes">Other changes</a></li>
</ul></li>
<li><a href="#new-features">New features</a>
<ul>
<li><a href="#vtortola-websocketlistener-support">vtortola.WebSocketListener support</a></li>
<li><a href="#rawsocket-transport-support">RawSocket transport support</a></li>
<li><a href="#progressive-calls">Progressive calls</a></li>
<li><a href="#caller-identification">Caller identification</a></li>
<li><a href="#wampinvocationcontext">WampInvocationContext</a></li>
<li><a href="#attribute-based-pub-sub">Attribute based pub/sub</a></li>
<li><a href="#wampeventcontext">WampEventContext</a></li>
<li><a href="#registration-customization">Registration customization</a></li>
<li><a href="#authentication">Authentication</a></li>
</ul></li>
<li><a href="#internal-changes">Internal Changes</a>
<ul>
<li><a href="#router-iwamprealmserviceprovider">Router IWampRealmServiceProvider</a></li>
<li><a href="#fleck-transport">Fleck transport</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
		</div>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Pages in Categories</h4>
		<ul class="sidebar-category-list">
		
			<li>
				<a href="http://wampsharp.net/categories/authentication">
					<span class="doc-list-category">Authentication</span>
				</a>
				<ul>
					<li><a href="/wamp2/client/client-side-authentication/">Client-side authentication</a>
					</li>
				
					<li><a href="/wamp2/router/cookie-based-router-side-authentication/">Cookie based router-side authentication</a>
					</li>
				
					<li><a href="/wamp2/router/router-side-authentication/">Router-side authentication</a>
					</li>
				
					<li><a href="/wamp2/client/wamp-cra-client-side-authentication/">WAMP-CRA client side authentication</a>
					</li>
				
					<li><a href="/wamp2/router/wamp-cra-router-side-authentication/">WAMP-CRA router-side authentication</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/callee">
					<span class="doc-list-category">Callee</span>
				</a>
				<ul>
					<li><a href="/wamp2/roles/callee/getting-started-with-callee/">Getting started with Callee</a>
					</li>
				
					<li><a href="/wamp2/roles/callee/raw-callee/">Raw Callee</a>
					</li>
				
					<li><a href="/wamp2/roles/callee/reflection-based-callee/">Reflection-based Callee</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/caller">
					<span class="doc-list-category">Caller</span>
				</a>
				<ul>
					<li><a href="/wamp2/roles/caller/getting-started-with-caller/">Getting started with Caller</a>
					</li>
				
					<li><a href="/wamp2/roles/caller/raw-caller/">Raw Caller</a>
					</li>
				
					<li><a href="/wamp2/roles/caller/reflection-based-caller/">Reflection-based Caller</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/client">
					<span class="doc-list-category">Client</span>
				</a>
				<ul>
					<li><a href="/wamp2/router/transports/rawsocket/">RawSocket transport</a>
					</li>
				
					<li><a href="/wamp2/client/client-side-authentication/">Client-side authentication</a>
					</li>
				
					<li><a href="/wamp2/meta-api-service/">Meta-api descriptor service</a>
					</li>
				
					<li><a href="/wamp2/client/wamp-cra-client-side-authentication/">WAMP-CRA client side authentication</a>
					</li>
				
					<li><a href="/wamp2/client/wampchannel/">WampChannel</a>
					</li>
				
					<li><a href="/wamp2/client/wampchannelreconnector/">WampChannelReconnector</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/getting-started">
					<span class="doc-list-category">Getting-Started</span>
				</a>
				<ul>
					<li><a href="/wamp2/roles/callee/getting-started-with-callee/">Getting started with Callee</a>
					</li>
				
					<li><a href="/wamp2/roles/caller/getting-started-with-caller/">Getting started with Caller</a>
					</li>
				
					<li><a href="/wamp2/roles/publisher/getting-started-with-publisher/">Getting started with Publisher</a>
					</li>
				
					<li><a href="/wamp2/roles/subscriber/getting-started-with-subscriber/">Getting started with Subscriber</a>
					</li>
				
					<li><a href="/wamp2/getting-started-with-wampv2/">Getting started with WAMPv2</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/publisher">
					<span class="doc-list-category">Publisher</span>
				</a>
				<ul>
					<li><a href="/wamp2/roles/publisher/getting-started-with-publisher/">Getting started with Publisher</a>
					</li>
				
					<li><a href="/wamp2/roles/publisher/raw-publisher/">Raw Publisher</a>
					</li>
				
					<li><a href="/wamp2/roles/publisher/reflection-based-publisher/">Reflection-based Publisher</a>
					</li>
				
					<li><a href="/wamp2/roles/publisher/rx-based-publisher/">Rx-based Publisher</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/release-notes">
					<span class="doc-list-category">Release-Notes</span>
				</a>
				<ul>
					<li><a href="/release-notes/wampsharp-v1.2.6.41-beta-release-notes/">WampSharp v1.2.6.41-beta release notes</a>
					</li>
				
					<li><a href="/release-notes/wampsharp-v1.2.5.21-beta-release-notes/">WampSharp v1.2.5.21-beta release notes</a>
					</li>
				
					<li><a href="/release-notes/wampsharp-v1.2.4.18-beta-release-notes/">WampSharp v1.2.4.18-beta release notes</a>
					</li>
				
					<li><a href="/release-notes/wampsharp-v1.2.3.12-beta-release-notes/">WampSharp v1.2.3.12-beta release notes</a>
					</li>
				
					<li><a href="/release-notes/wampsharp-v1.2.2.8-beta-release-notes/">WampSharp v1.2.2.8-beta release notes</a>
					</li>
				
					<li>
						<span class="active">WampSharp v1.2.1.6-beta release notes</span>
						</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/roadmap">
					<span class="doc-list-category">Roadmap</span>
				</a>
				<ul>
					<li><a href="/roadmap/">Roadmap</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/router">
					<span class="doc-list-category">Router</span>
				</a>
				<ul>
					<li><a href="/wamp2/router/transports/rawsocket/">RawSocket transport</a>
					</li>
				
					<li><a href="/wamp2/router/transports/websocket/">WebSocket transports</a>
					</li>
				
					<li><a href="/wamp2/router/cookie-based-router-side-authentication/">Cookie based router-side authentication</a>
					</li>
				
					<li><a href="/wamp2/meta-api-service/">Meta-api descriptor service</a>
					</li>
				
					<li><a href="/wamp2/router/router-side-authentication/">Router-side authentication</a>
					</li>
				
					<li><a href="/wamp2/router/wamp-cra-router-side-authentication/">WAMP-CRA router-side authentication</a>
					</li>
				
					<li><a href="/wamp2/router/wamphost/">WampHost</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/subscriber">
					<span class="doc-list-category">Subscriber</span>
				</a>
				<ul>
					<li><a href="/wamp2/roles/subscriber/getting-started-with-subscriber/">Getting started with Subscriber</a>
					</li>
				
					<li><a href="/wamp2/roles/subscriber/raw-subscriber/">Raw Subscriber</a>
					</li>
				
					<li><a href="/wamp2/roles/subscriber/reflection-based-subscriber/">Reflection-based Subscriber</a>
					</li>
				
					<li><a href="/wamp2/roles/subscriber/rx-based-subscriber/">Rx-based Subscriber</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://wampsharp.net/categories/wamp1">
					<span class="doc-list-category">Wamp1</span>
				</a>
				<ul>
					<li><a href="/wamp1/getting-started-with-wampv1/">Getting started with WAMPv1</a>
					</li>
				
					<li><a href="/wamp1/getting-started-with-wampv1-client/">Getting started with WAMPv1 client</a>
					</li>
				
					<li><a href="/wamp1/notes-for-wampv1-users/">Notes for WAMP1 users</a>
					</li>
				
					<li><a href="/wamp1/server-pubsub-hosting-wampv1/">Server PubSub hosting (WAMPv1)</a>
					</li>
				
					<li><a href="/wamp1/server-rpc-hosting-wampv1/">Server RPC hosting (WAMPv1)</a>
					</li>
				
				</ul>
			</li>
		
		</ul>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Tags</h4>
		<div class="tag-box">
		
			<a class="tag-item" href="http://wampsharp.net/tags/authentication">authentication</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/callee">callee</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/caller">caller</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/client">client</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/publisher">publisher</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/raw-api">raw-api</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/reflection">reflection</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/roadmap">roadmap</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/router">router</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/rx">rx</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/services">services</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/subscriber">subscriber</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/transports">transports</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/wamp1">wamp1</a>
		
			<a class="tag-item" href="http://wampsharp.net/tags/wampcra">wampcra</a>
		
		</div>
	</div>
	</div>
</div>

</div> 


<hr />

<div class="row">
	<div class="col-sm-8">
		<p class="doc-footer-em"><a href="#" onclick="resetSidebarPos()">Back to TOP</a></p>
	</div>
</div>

</div> 

<footer class="doc-footer">
	
	<p>Copyright (c) 2013-2017, Elad Zelingher; All rights reserved.</p>
	<p>Powered by <strong><a href="https://github.com/progrhyme/hugo-theme-bootie-docs">Bootie Docs</a></strong> - theme for <a href="http://gohugo.io/">Hugo</a> by <a href="https://github.com/progrhyme/">progrhyme</a>.</p>
</footer>



<script src="http://wampsharp.net/js/jquery.min.js"></script>
<script src="http://wampsharp.net/js/bootstrap.min.js"></script>

<script src="http://wampsharp.net/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="http://wampsharp.net/js/ie10-viewport-bug-workaround.js"></script>
<script src="http://wampsharp.net/js/bootie-docs.js"></script>

</body>
</html>
